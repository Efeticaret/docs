<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Microsoft OneDrive &mdash; Cyberduck Help  documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SFTP" href="SFTP.html" />
    <link rel="prev" title="iRODS (Integrated Rule-Oriented Data System)" href="iRODS.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #5a5a5a" >
            <a href="../index.html"><img src="../_static/cyberduck-icon-64.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Microsoft OneDrive</a></li>
<li><a class="reference internal" href="#connecting">Connecting</a><ul>
<li><a class="reference internal" href="#multiple-accounts">Multiple Accounts</a></li>
<li><a class="reference internal" href="#oauth-reset">OAuth Reset</a></li>
<li><a class="reference internal" href="#expiry">Expiry</a></li>
<li><a class="reference internal" href="#which-protocol-to-choose">Which protocol to choose?</a><ul>
<li><a class="reference internal" href="#office-365-deutschland">Office 365 Deutschland</a></li>
</ul>
</li>
<li><a class="reference internal" href="#administrator-consent-required">Administrator Consent Required</a><ul>
<li><a class="reference internal" href="#manually-adding-cyberduck-mountain-duck">Manually Adding Cyberduck &amp; Mountain Duck</a></li>
<li><a class="reference internal" href="#automatically-allow-users-to-add-apps-to-the-domain">Automatically Allow Users to add Apps to the Domain</a></li>
<li><a class="reference internal" href="#admin-consent-requests-preview">Admin Consent Requests (Preview)</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#cyberduck-cli">Cyberduck CLI</a></li>
<li><a class="reference internal" href="#search">Search</a></li>
<li><a class="reference internal" href="#limitations">Limitations</a></li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #5a5a5a" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Cyberduck Help</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Protocols</a> &raquo;</li>
      <li>Microsoft OneDrive</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/iterate-ch/docs/edit/main/Protocols/OneDrive.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="tex2jax_ignore mathjax_ignore section" id="microsoft-onedrive">
<h1>Microsoft OneDrive<a class="headerlink" href="#microsoft-onedrive" title="Permalink to this headline"></a></h1>
<p><img alt="OneDrive Drive Icon" src="../_images/onedrive_128.png" /></p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="connecting">
<h1>Connecting<a class="headerlink" href="#connecting" title="Permalink to this headline"></a></h1>
<blockquote>
<div><p>Microsoft Graph, OneDrive, and SharePoint support using a standard OAuth2 authorization flow.</p>
</div></blockquote>
<p>The OneDrive connection profile is bundled by default and connects to the endpoint <code class="docutils literal notranslate"><span class="pre">https://graph.microsoft.com/v1.0/me</span></code>. Login with your personal or business account to <code class="docutils literal notranslate"><span class="pre">login.microsoftonline.com</span></code> when prompted to grant access to Cyberduck.</p>
<ol>
<li><p>OneDrive uses OAuth 2 for authentication with <code class="docutils literal notranslate"><span class="pre">graph.microsoft.com</span></code>. When opening a connection, a web browser window is opened to grant access to OneDrive for Cyberduck.</p>
<a class="reference internal image-reference" href="../_images/Microsoft_OneDrive_OAuth_Authorization.png"><img alt="OAuth 2 Authentication" src="../_images/Microsoft_OneDrive_OAuth_Authorization.png" style="width: 500px;" /></a>
</li>
<li><p>Copy the authorization code into the login prompt in Cyberduck to complete authentication. Subsequent connections will not require authorization, unless the refresh token itself is expired due to inactivity.
<img alt="OAuth 2 Prompt" src="../_images/OneDrive_OAuth_2_Authorization.png" /></p></li>
</ol>
<div class="section" id="multiple-accounts">
<h2>Multiple Accounts<a class="headerlink" href="#multiple-accounts" title="Permalink to this headline"></a></h2>
<p>You can connect to multiple accounts at the same time. Create a new bookmark for every account and run through the OAuth flow.</p>
</div>
<div class="section" id="oauth-reset">
<h2>OAuth Reset<a class="headerlink" href="#oauth-reset" title="Permalink to this headline"></a></h2>
<p>If you have accidentally logged in with the wrong OneDrive Account or want to change the login of the OneDrive bookmark you can reset the OAuth token by deleting the entries related to <code class="docutils literal notranslate"><span class="pre">https://Microsoft</span> <span class="pre">OneDrive</span> <span class="pre">(user)&#64;login.microsoft.com</span></code> out of the <em>Windows Credential Manager</em> or on macOS out of <em>Keychain Access.app</em>.</p>
</div>
<div class="section" id="expiry">
<h2>Expiry<a class="headerlink" href="#expiry" title="Permalink to this headline"></a></h2>
<p>All authentication codes expire after 90 days. If you get the error message <code class="docutils literal notranslate"><span class="pre">Forbidden.</span> <span class="pre">The</span> <span class="pre">caller</span> <span class="pre">doesn't</span> <span class="pre">have</span> <span class="pre">permission</span> <span class="pre">to</span> <span class="pre">perform</span> <span class="pre">the</span> <span class="pre">action.</span> <span class="pre">[...]</span></code> due to this known issue remove all entries that are related to <code class="docutils literal notranslate"><span class="pre">Microsoft</span> <span class="pre">OneDrive</span></code> and <code class="docutils literal notranslate"><span class="pre">graph.microsoft.com</span></code> from <em>Keychain Access.app</em> or <em>Windows Credential Manager</em>. After that, you’ll be prompted to reauthenticate.</p>
</div>
<div class="section" id="which-protocol-to-choose">
<h2>Which protocol to choose?<a class="headerlink" href="#which-protocol-to-choose" title="Permalink to this headline"></a></h2>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Allows access to</p></th>
<th class="head"><p>Remarks</p></th>
<th class="text-align:center head"><p>Bundled by default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Microsoft OneDrive</p></td>
<td><p>Your Drive, and shared files</p></td>
<td><p>Works with your personal and business OneDrive</p></td>
<td class="text-align:center"><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="SharePoint.html"><span class="doc std std-doc">Microsoft SharePoint</span></a></p></td>
<td><p>All sites document libraries and accessible group document libraries<br/><br/><strong>prior Cyberduck 7.8 / Mountain Duck 4.4:</strong> The default sites document libraries and accessible group document libraries</p></td>
<td><p>The connection profile is named Microsoft SharePoint Online in versions <strong>prior Cyberduck 7.8 / Mountain Duck 4.4</strong></p></td>
<td class="text-align:center"><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>Microsoft SharePoint Site</p></td>
<td><p>A single SharePoint Site which isn’t listed within the <em>Microsoft SharePoint profile</em></p></td>
<td><p>Can’t mount specific directories</p></td>
<td class="text-align:center"><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>Microsoft SharePoint Document Library</p></td>
<td><p>Can’t mount specific directories</p></td>
<td><p>Does not allow access to groups<br/><br/>Only needed for versions <strong>prior Cyberduck 6.9 / Mountain Duck 2.7</strong></p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
</tbody>
</table>
<div class="section" id="office-365-deutschland">
<h3>Office 365 Deutschland<a class="headerlink" href="#office-365-deutschland" title="Permalink to this headline"></a></h3>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The separate <code class="docutils literal notranslate"><span class="pre">Microsoft</span> <span class="pre">Cloud</span> <span class="pre">Deutschland</span></code> won’t be available anymore after 26. Oct 2021. For more information regarding the migration refer to this <a class="reference external" href="https://www.microsoft.com/de-de/cloud-platform/germany-cloud-regions">announcement article</a>.</p>
</div>
<ol class="simple">
<li><p><a class="reference download external" download="" href="https://svn.cyberduck.io/trunk/profiles/Microsoft%20365%20China%20OneDrive.cyberduckprofile"><code class="xref download docutils literal notranslate"><span class="pre">Download</span></code></a> the <em>Microsoft Office 365 Deutschland OneDrive</em> profile</p></li>
<li><p>Use the <em>Microsoft Office 365 Deutschland OneDrive profile</em> and login with your <code class="docutils literal notranslate"><span class="pre">*.onmicrosoft.de</span></code> account to <code class="docutils literal notranslate"><span class="pre">login.microsoftonline.de</span></code> to connect to your OneDrive</p></li>
</ol>
</div>
</div>
<div class="section" id="administrator-consent-required">
<h2>Administrator Consent Required<a class="headerlink" href="#administrator-consent-required" title="Permalink to this headline"></a></h2>
<p>Depending on the setup of your AAD you may need to perform several steps in order for you to be able to access your OneDrive. Please get in contact with your domain administrator for following steps.</p>
<div class="section" id="manually-adding-cyberduck-mountain-duck">
<h3>Manually Adding Cyberduck &amp; Mountain Duck<a class="headerlink" href="#manually-adding-cyberduck-mountain-duck" title="Permalink to this headline"></a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Cyberduck 7.8 and later or Mountain Duck 4.4 and later required</p>
</div>
<p>Copy the link that corresponds to your used version, and send it to your domain administrator, this will add Cyberduck to the domain and all users are allowed to access Cyberduck in the future.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://login.microsoftonline.com/organizations/v2.0/adminconsent?client_id=f40bc18f-cd02-4212-b7f1-15243e4e2ad3&amp;redirect_uri=https://cyberduck.io/oauth&amp;scope=sites.readwrite.all%20files.readwrite.all%20offline_access%20user.read">Grant administrator consent</a></p></li>
</ul>
</div>
<div class="section" id="automatically-allow-users-to-add-apps-to-the-domain">
<h3>Automatically Allow Users to add Apps to the Domain<a class="headerlink" href="#automatically-allow-users-to-add-apps-to-the-domain" title="Permalink to this headline"></a></h3>
<p>If applicable and trusted you may set <code class="docutils literal notranslate"><span class="pre">Users</span> <span class="pre">can</span> <span class="pre">consent</span> <span class="pre">to</span> <span class="pre">apps</span> <span class="pre">accessing</span> <span class="pre">company</span> <span class="pre">data</span> <span class="pre">on</span> <span class="pre">their</span> <span class="pre">behalf</span></code> to <code class="docutils literal notranslate"><span class="pre">Yes</span></code> at the <a class="reference external" href="https://aad.portal.azure.com/#blade/Microsoft_AAD_IAM/StartboardApplicationsMenuBlade/UserSettings">AAD Portal</a>. This will allow users in the future to add apps without Admin-consent.</p>
</div>
<div class="section" id="admin-consent-requests-preview">
<h3>Admin Consent Requests (Preview)<a class="headerlink" href="#admin-consent-requests-preview" title="Permalink to this headline"></a></h3>
<p>There is a preview method of review application consent through the AAD Portal. Please enable <code class="docutils literal notranslate"><span class="pre">Users</span> <span class="pre">can</span> <span class="pre">request</span> <span class="pre">admin</span> <span class="pre">consent</span> <span class="pre">to</span> <span class="pre">apps</span> <span class="pre">they</span> <span class="pre">are</span> <span class="pre">unable</span> <span class="pre">to</span> <span class="pre">consent</span> <span class="pre">to</span></code> to <code class="docutils literal notranslate"><span class="pre">Yes</span></code> in the <a class="reference external" href="https://aad.portal.azure.com/#blade/Microsoft_AAD_IAM/StartboardApplicationsMenuBlade/UserSettings">Enterprise applications - User settings</a>. The domain administrator may now review all consents centrally at <a class="reference external" href="https://aad.portal.azure.com/#blade/Microsoft_AAD_IAM/StartboardApplicationsMenuBlade/AccessRequests">Admin consent requests (Preview)</a>.</p>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="cyberduck-cli">
<h1>Cyberduck CLI<a class="headerlink" href="#cyberduck-cli" title="Permalink to this headline"></a></h1>
<p>You can list the root contents of your OneDrive with <a class="reference external" href="https://duck.sh/">Cyberduck CLI</a> using</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>duck --list onedrive:/
</pre></div>
</div>
<p>Refer to the <a class="reference internal" href="../CLI/index.html"><span class="doc std std-doc">Cyberduck CLI</span></a> documentation for more operations. For subsequent invocations make sure to include the <code class="docutils literal notranslate"><span class="pre">--username</span></code> parameter and set it to the email address registered with Microsoft to allow the lookup of previously saved OAuth tokens.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="search">
<h1>Search<a class="headerlink" href="#search" title="Permalink to this headline"></a></h1>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This only applies to Cyberduck.</p>
</div>
<p>You can <a class="reference external" href="../Cyberduck/Browser#filter-search">search recursively</a> for files fast without browsing folders first.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="limitations">
<h1>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline"></a></h1>
<p>There are some limitations that you should keep in mind while working with.</p>
<ul class="simple">
<li><p>We’ve added support for Microsoft 365 China in <strong>Cyberduck 7.8 / Mountain Duck 4.4</strong> but aren’t able to verify if it works properly.</p></li>
<li><p>No interoperability with Microsoft 365 for US Government (other services may apply as well)</p></li>
</ul>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="iRODS.html" class="btn btn-neutral float-left" title="iRODS (Integrated Rule-Oriented Data System)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="SFTP.html" class="btn btn-neutral float-right" title="SFTP" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021 iterate GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>